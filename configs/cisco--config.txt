=== SOLUTION ARCHITECTURE BLUEPRINT ===

Device Models and Roles:
- Router: Cisco ISR 4331 - Core/WAN Router, VLAN Routing, Secure WAN, PCI Segmentation
- L3 Switch: Catalyst 9300 - Datacenter/Collapsed Core, VLAN Aggregation, 802.1X, QoS, RBAC
- Firewall: ASA 5516-X - Segmentation Firewall, IDS/IPS, PCI-DSS Policy Enforcement, Audit Logging
- WLC: Cisco 5520 Wireless LAN Controller - Secure WLAN, VLAN, AAA, WPA3-Enterprise, Logging

Network Topology Description:
- Collapsed core topology with two-tier (Core/Distribution) L3 switch redundancy, resilient WAN, segmented VLANs.
- ISR 4331 connects to WAN/Internet (dual uplink: wired and LTE/4G backup), peer L3 handoff to C9300 (trunk and L3 link), full OSPFv2.
- ASA 5516-X operative as segmentation firewall between trusted, untrusted, DMZ VLANs (context-aware ACLs, active intrusion prevention, PCI-DSS isolation).
- Cisco 5520 WLC provides centralized secure wireless for Guest/Staff; traffic carried on dedicated VLANs; APs authenticated using 802.1X and WPA3-Enterprise.
- End-to-end security: AAA, Tacacs+/RADIUS, SSHv2, RBAC, syslog/SIEM integration, periodic vulnerability scanning via scheduled jobs/scripts.
- Multi-layer logging, monitoring, and compliance data aggregation (NMS/SIEM/SNMPv3/Secure syslog).
- P2P links between router, switch, ASA use /30s in 10.10.255.0/24; Trunks carry all VLANs.

CRITICAL P2P VALIDATION REQUIREMENTS:
(See device configs; all P2P /30s, interface descriptions, and peer IPs precisely aligned.)

---

=== DEVICE 1: CORE-ROUTER (ISR4331) ===
! ===== SECTION: Basic Configuration =====
hostname CORE-ROUTER
!
no ip domain-lookup
ip domain-name fincorebank.local
!
service timestamps log datetime msec
service password-encryption
!
enable secret 9 S0m3$tr0ngSecretP@ss
!
aaa new-model
aaa authentication login default group radius local
aaa authorization exec default group radius local
aaa accounting exec default start-stop group radius
!
radius-server host 192.168.100.10 auth-port 1812 acct-port 1813 key SuperSecureAAAKey
!
username secops privilege 15 secret Syst3mAdm!n#
!
logging buffered 64000
logging host 192.168.100.100 transport tcp port 514
logging trap informational
!
clock timezone EST -5
ntp server 192.168.100.200
!
crypto key generate rsa modulus 4096 label SSH-KEY
ip ssh version 2
ip ssh authentication-retries 3
ip ssh time-out 60
!
line vty 0 4
 transport input ssh
 session-timeout 8
 login local
!
banner motd ^C
 UNAUTHORIZED ACCESS TO THIS DEVICE IS PROHIBITED
 All activity is logged and monitored per PCI-DSS requirements.
^C
!
password policy
 history 10
 min-length 12
 lifetime 60
!
interface Loopback0
 description Management Loopback
 ip address 192.168.100.1 255.255.255.255
!
! ===== END SECTION =====

! ===== SECTION: Interface Configuration =====
!
interface GigabitEthernet0/0/0
 description WAN PRIMARY - ISP1 (100Mbps)
 ip address dhcp
 ip nat outside
 speed 100
 duplex full
!
interface GigabitEthernet0/0/1
 description WAN BACKUP - LTE/4G (50Mbps)
 ip address dhcp
 ip nat outside
 backup interface GigabitEthernet0/0/0
 speed 100
 duplex full
!
interface GigabitEthernet0/1/0
 description P2P: CORE-SW (C9300) Gi1/1 (Trust Zone)
 ip address 10.10.255.1 255.255.255.252
 no shutdown
!
interface GigabitEthernet0/1/1
 description P2P: ASA-5516-X Gi0/2 (Firewall Segment)
 ip address 10.10.255.5 255.255.255.252
 no shutdown
!
interface GigabitEthernet0/1/2
 description P2P: MGMT-SWITCH vx (Out-of-band Mgmt)
 ip address 192.168.100.2 255.255.255.0
!
! SVIs for VLAN routing, HSRP etc handled on core switch
!
! ===== END SECTION =====

! ===== SECTION: NAT, Routing Protocols, VRF Config =====
!
ip route 0.0.0.0 0.0.0.0 GigabitEthernet0/0/0 10 track 1
ip route 0.0.0.0 0.0.0.0 GigabitEthernet0/0/1 254
!
router ospf 100
 router-id 1.1.1.1
 passive-interface default
 no passive-interface GigabitEthernet0/1/0
 no passive-interface GigabitEthernet0/1/1
 network 10.10.255.0 0.0.0.255 area 0
 network 192.168.100.0 0.0.0.255 area 0
!
ip nat inside source list NAT_INSIDE interface GigabitEthernet0/0/0 overload
access-list NAT_INSIDE permit ip 192.168.10.0 0.0.0.255 any
access-list NAT_INSIDE permit ip 192.168.20.0 0.0.0.255 any
access-list NAT_INSIDE permit ip 192.168.30.0 0.0.0.255 any
access-list NAT_INSIDE permit ip 192.168.40.0 0.0.0.255 any
access-list NAT_INSIDE permit ip 192.168.50.0 0.0.0.255 any
access-list NAT_INSIDE permit ip 192.168.60.0 0.0.0.255 any
!
! ===== END SECTION =====

! ===== SECTION: Security & Compliance =====
!
crypto pki trustpoint SECURE-TLS
 enrollment selfsigned
 subject-name CN=CORE-ROUTER.finbank.local
 revocation-check none
 rsakeypair SSH-KEY
!
!
crypto ipsec ikev2 policy 1
 encryption aes-256
 integrity sha256
 group 21
 prf sha256
!
crypto ipsec profile PCI-TUNNEL
 set transform-set AES256-SHA
!
! OOB Management Access Control
ip access-list extended MGMT_ACCESS
 permit ip 192.168.100.0 0.0.0.255 any
!
!--- Outbound anti-spoofing (RFC1918 blocks denied inbound on WAN)
ip access-list extended ANTI_SPOOFING
 deny ip 10.0.0.0 0.255.255.255 any log
 deny ip 172.16.0.0 0.15.255.255 any log
 deny ip 192.168.0.0 0.0.255.255 any log
 permit ip any any
!
interface GigabitEthernet0/0/0
 ip access-group ANTI_SPOOFING in
!
! PCI-DSS Monitoring
snmp-server community SECURESNMP RO 99
snmp-server enable traps syslog
snmp-server host 192.168.100.100 version 3 security pciadmin
!
! Scheduled vulnerability scans (using EEM applet trigger)
event manager applet SCHEDULED_VULN_SCAN
 event timer cron name scancron cron-entry "0 2 * * MON"
 action 10 syslog msg "INITIATING PCI-DSS MANDATED VULNERABILITY SCAN"
! Scripting for actual scan is handled by external compliance servers/NMS
!
! ===== END SECTION =====

copy running-config startup-config

---

=== DEVICE 2: CORE-SW (C9300) ===
! ===== SECTION: Basic Configuration =====
hostname CORE-SW
!
ip domain-name fincorebank.local
!
service password-encryption
enable secret 9 B4nkP@ssw0rd#Secur3
!
aaa new-model
aaa authentication dot1x default group radius
aaa authentication login default group radius local
aaa authorization exec default group radius
aaa accounting exec default start-stop group radius
!
radius-server host 192.168.100.10 auth-port 1812 acct-port 1813 key SuperSecureAAAKey
!
logging buffered 128000 notifications
logging host 192.168.100.100 transport tcp port 514
logging trap informational
ntp server 192.168.100.200
!
clock timezone EST -5
!
username admin privilege 15 secret C@t9300$up3rAdm
!
crypto key generate rsa modulus 4096 label SSH-KEY
ip ssh version 2
ip ssh authentication-retries 3
ip ssh time-out 60
!
line vty 0 15
 transport input ssh
 login local
 exec-timeout 10 0
!
banner login ^
ACCESS RESTRICTED: This is a PCI-DSS Zone network device.
All access is logged and monitored.
^

password policy
 history 10
 min-length 16
 lifetime 60
!
!
! ===== END SECTION =====

! ===== SECTION: VLAN & Trunking =====
vlan 10
 name "CoreBanking"
vlan 20
 name "ATMs"
vlan 30
 name "Tellers"
vlan 40
 name "GuestWiFi"
vlan 50
 name "SecurityCameras"
vlan 60
 name "VoIP"
vlan 100
 name "Management"
!
vlan 900
 name "PCI-Isolation"
!
interface range GigabitEthernet1/1, GigabitEthernet1/2
 description Uplink: CORE-ROUTER/ASA-5516-X (Trunks)
 switchport trunk encapsulation dot1q
 switchport mode trunk
 switchport trunk allowed vlan 10,20,30,40,50,60,100,900
 spanning-tree portfast trunk
!
interface port-channel10
 description LINK: SERVER_AGGREGATE (LACP)
 switchport mode trunk
!
interface range GigabitEthernet1/5-1/8
 description User/Voice/Mgmt edge access (802.1X and MultiAuth)
 switchport mode access
 switchport access vlan 10
 authentication port-control auto
 dot1x pae authenticator
 spanning-tree portfast
!
interface range GigabitEthernet1/9-1/12
 description ATM edge access
 switchport mode access
 switchport access vlan 20
 authentication port-control auto
 dot1x pae authenticator
 spanning-tree portfast
!
! Guest WiFi
interface range GigabitEthernet1/13-1/16
 description WLAN AP Uplink
 switchport mode access
 switchport access vlan 40
 spanning-tree portfast
!
! Voice VLAN
interface range GigabitEthernet1/17-1/24
 description IP Phones
 switchport mode access
 switchport access vlan 60
 switchport voice vlan 60
 mls qos trust dscp
 spanning-tree portfast
!
! Camera VLAN
interface range GigabitEthernet1/25-1/30
 description Security Cameras
 switchport mode access
 switchport access vlan 50
 spanning-tree portfast
!
! Management VLAN
interface range GigabitEthernet1/48
 description OOB Management Station
 switchport mode access
 switchport access vlan 100
 spanning-tree portfast
!
! ===== END SECTION =====

! ===== SECTION: SVI/Layer 3 Interfaces =====
interface Vlan10
 description Core Banking
 ip address 192.168.10.1 255.255.255.0
 ip helper-address 192.168.100.20
 ip ospf 100 area 0
!
interface Vlan20
 description ATMs
 ip address 192.168.20.1 255.255.255.0
 ip helper-address 192.168.100.20
 ip ospf 100 area 0
!
interface Vlan30
 description Tellers
 ip address 192.168.30.1 255.255.255.0
 ip helper-address 192.168.100.20
 ip ospf 100 area 0
!
interface Vlan40
 description Guest WiFi
 ip address 192.168.40.1 255.255.255.0
 ip helper-address 192.168.100.20
 ip ospf 100 area 0
!
interface Vlan50
 description Security/Cameras
 ip address 192.168.50.1 255.255.255.0
 ip ospf 100 area 0
!
interface Vlan60
 description VoIP
 ip address 192.168.60.1 255.255.255.0
 ip ospf 100 area 0
!
interface Vlan100
 description Management
 ip address 192.168.100.11 255.255.255.0
 ip ospf 100 area 0
!
interface Vlan900
 description PCI-Isolation
 ip address 10.90.90.1 255.255.255.0
 shutdown
!
interface GigabitEthernet1/1
 description P2P: CORE-ROUTER Gi0/1/0
 no switchport
 ip address 10.10.255.2 255.255.255.252
 ip ospf 100 area 0
!
interface GigabitEthernet1/2
 description P2P: ASA-5516-X Gi0/2
 no switchport
 ip address 10.10.255.6 255.255.255.252
 ip ospf 100 area 0
!
interface Loopback0
 description OSPF Router-ID
 ip address 10.10.10.10 255.255.255.255
!
! ===== END SECTION =====

! ===== SECTION: Routing, Redundancy, and QoS =====
router ospf 100
 router-id 10.10.10.10
 network 10.10.255.2 0.0.0.0 area 0
 network 10.10.255.6 0.0.0.0 area 0
 network 192.168.10.0 0.0.0.255 area 0
 network 192.168.20.0 0.0.0.255 area 0
 network 192.168.30.0 0.0.0.255 area 0
 network 192.168.40.0 0.0.0.255 area 0
 network 192.168.50.0 0.0.0.255 area 0
 network 192.168.60.0 0.0.0.255 area 0
 network 192.168.100.0 0.0.0.255 area 0
!
! HSRP for SVI redundancy (if required for dual-core scenario)
!interface Vlan10
! standby 10 ip 192.168.10.254
! standby 10 priority 110
! standby 10 preempt
!
! QoS for VoIP Traffic
mls qos
policy-map VOIP-QOS
 class voice
  priority percent 30
 class class-default
  fair-queue
!
interface range GigabitEthernet1/17-1/24
 service-policy input VOIP-QOS
 service-policy output VOIP-QOS
!
! ===== END SECTION =====

! ===== SECTION: Security & Monitoring =====
!
! 802.1X
dot1x system-auth-control
!
! Restrict VLAN 900 (PCI Cardholder isolation) - block inter-VLAN
vlan access-map PCI-DENY 10
 match vlan 900
 action drop
!
! Bogon/Private packets
ip access-list extended BOGON-DROP
 deny ip 10.0.0.0 0.255.255.255 any log
 deny ip 172.16.0.0 0.15.255.255 any log
 deny ip 192.168.0.0 0.0.255.255 any log
 permit ip any any
!
! Management ACL
ip access-list extended MGMT-ONLY
 permit ip 192.168.100.0 0.0.0.255 any
 deny ip any any log
!
interface Vlan100
 ip access-group MGMT-ONLY in
!
! AAA, SNMPv3, Logging
snmp-server group SECURE v3 priv
snmp-server user auditadmin SECURE v3 auth sha SECUREPASS123 priv aes 256 SECURESNMPKEY
snmp-server enable traps syslog
snmp-server host 192.168.100.100 version 3 auditadmin
!
! SIEM/Syslog config
logging trap notifications
logging host 192.168.100.100
!
! Scheduled compliance config audits
event manager applet PCI-COMPLIANCE-AUDIT
 event timer cron name auditcron cron-entry "15 3 * * *"
 action 10 syslog msg "Scheduled PCI-DSS compliance config snapshot."
! (External SIEM collects outputs via SCP/SFTP)
!
! ==== END SECTION ====

copy running-config startup-config

---

=== DEVICE 3: ASA-FW (ASA 5516-X) ===
! ===== SECTION: Basic Configuration =====
hostname ASA-FW
!
interface Management0/0
 nameif management
 security-level 100
 ip address 192.168.100.21 255.255.255.0
!
interface GigabitEthernet0/1
 nameif inside
 security-level 100
 ip address 10.10.255.10 255.255.255.252
!
interface GigabitEthernet0/2
 nameif core
 security-level 90
 ip address 10.10.255.7 255.255.255.252
!
interface GigabitEthernet0/3
 nameif outside
 security-level 0
 ip address dhcp
!
interface GigabitEthernet0/4
 nameif dmz
 security-level 50
 ip address 192.168.200.2 255.255.255.0
!
no shutdown
!
!
! AAA & Admin
aaa-server RADIUS-SERVERS protocol radius
aaa-server RADIUS-SERVERS (inside) host 192.168.100.10
 key SuperSecureAAAKey
!
aaa authentication ssh console RADIUS-SERVERS LOCAL
aaa authentication enable console RADIUS-SERVERS LOCAL
!
username pciaudit password pciauditpass privilege 15
!
enable password enablepw123
!
ssh version 2
ssh key-exchange group dh-group14-sha256
ssh stricthostkeycheck
ssh 192.168.100.0 255.255.255.0 management
!
logging enable
logging host management 192.168.100.100
logging trap notifications
logging permit-hostdown
!
ntp server 192.168.100.200
clock timezone EST -5
!
! ===== END SECTION =====

! ===== SECTION: Security Policies & Firewall ACLs =====
!
object network obj_CORE_BANK
 subnet 192.168.10.0 255.255.255.0
object network obj_ATM
 subnet 192.168.20.0 255.255.255.0
object network obj_TELLERS
 subnet 192.168.30.0 255.255.255.0
object network obj_GUEST
 subnet 192.168.40.0 255.255.255.0
object network obj_CAMS
 subnet 192.168.50.0 255.255.255.0
object network obj_VOIP
 subnet 192.168.60.0 255.255.255.0
object network obj_MGMT
 subnet 192.168.100.0 255.255.255.0
!
access-list PCI-CARDHOLDER extended permit ip obj_CORE_BANK any
access-list PCI-CARDHOLDER extended deny ip obj_GUEST any log
access-list PCI-CARDHOLDER extended deny ip obj_ATM any log
access-list PCI-CARDHOLDER extended deny ip obj_TELLERS any log
access-list PCI-CARDHOLDER extended deny ip obj_CAMS any log
access-list PCI-CARDHOLDER extended permit ip obj_MGMT obj_CORE_BANK
access-list GUEST-ACCESS extended permit ip obj_GUEST any
!
access-group PCI-CARDHOLDER in interface core
access-group GUEST-ACCESS in interface dmz
!
!
! IDS/IPS (FirePOWER Policies central management)
! IPS Policy: PCI-IDS, Mode: Prevention
!
!
! VPN Access for auditors (AES-256)
crypto ikev2 policy 1
 encryption aes-256
 integrity sha256
 group 21
 prf sha256
!
tunnel-group 192.168.210.0/24 type remote-access
tunnel-group 192.168.210.0/24 general-attributes
 address-pool audit-vpn-pool
 default-group-policy PCI-auditors
 authentication-server-group RADIUS-SERVERS
tunnel-group 192.168.210.0/24 ipsec-attributes
 ikev2 remote-authentication pre-shared-key SecureAud1tKey
 ikev2 local-authentication pre-shared-key SecureAud1tKey
!
! VPN address pool
ip local pool audit-vpn-pool 192.168.210.10-192.168.210.20 mask 255.255.255.0
!
group-policy PCI-auditors internal
group-policy PCI-auditors attributes
 vpn-tunnel-protocol ikev2
 split-tunnel-policy tunnelspecified
 split-tunnel-network-list value PCI_AUDIT_NETS
!
access-list PCI_AUDIT_NETS standard permit 192.168.10.0 255.255.255.0
access-list PCI_AUDIT_NETS standard permit 192.168.100.0 255.255.255.0
!
! ===== END SECTION =====

! ===== SECTION: Logging & Monitoring =====
!
logging class audit level notifications, warnings, errors
logging host inside 192.168.100.100
logging trap notifications
logging monitor informational
!
! Syslog - Forward to SIEM
logging trap informational
logging host management 192.168.100.100
!
! SNMP
snmp-server community SECURESNMP RO
snmp-server host management 192.168.100.100 community SECURESNMP
!
! Scheduled Vulnerability Scans (external triggers)
event manager applet PCI-SCAN
 event timer watchdog time 86400
 action 1.0 syslog msg "External compliance scan window opened"
!
! IDS/IPS: FirePOWER policy via FMC (central management)
!
! ===== END SECTION =====

write memory

---

=== DEVICE 4: BANK-WLC (5520 WLC) ===
! ===== SECTION: Basic Configuration =====
config t
!
ap name AP-STAFF location "Staff Floor 1"
ap name AP-GUEST location "Lobby"
!
wireless management interface vlan 100
interface vlan 100
 ip address 192.168.100.50 255.255.255.0
!
! ===== END SECTION =====

! ===== SECTION: WLANs, AAA & Security =====
!
wlan CORE-STAFF 10 STAFF_SSID
 vlan 10
 security wpa wpa2 wpa3
 security wpa akm 802.1x
 security wpa wpa2 ciphers aes
 security wpa wpa3 ciphers aes-256
!
wlan GUEST-ACCESS 40 GUEST_WIFI
 vlan 40
 security wpa wpa2 wpa3
 security wpa akm 802.1x
 security wpa wpa2 ciphers aes-256
 security wpa wpa3 ciphers aes-256
!
radius server FIN_RADIUS
 address ipv4 192.168.100.10 auth-port 1812 acct-port 1813
 key SuperSecureAAAKey
!
aaa authentication dot1x default group radius
!
! Authentication Policy
policy profile STAFF_POLICY
 vlan 10
 nac state enable
 authoriz-override enable
!
policy profile GUEST_POLICY
 vlan 40
 nac state enable
 authoriz-override enable
!
! Assign policies to WLANs
wlan CORE-STAFF policy STAFF_POLICY
wlan GUEST-ACCESS policy GUEST_POLICY
!
! ==== END SECTION ====

! ===== SECTION: Logging & Monitoring =====
!
logging syslog server 192.168.100.100
logging trap informational
!
snmp-server community SECURESNMP RO
snmp-server host 192.168.100.100 version 2c SECURESNMP
!
clock timezone EST -5
ntp server 192.168.100.200
!
! Compliance-specific scheduled task: config snapshot
shell trigger cron "30 2 * * MON" cli "show running-config | redirect tftp://192.168.100.101/WLC_SNAPSHOT"
!
! ==== END SECTION ====

save config


---

=== DEPLOYMENT RECOMMENDATIONS ===

Installation Sequence:
1. Deploy ISR 4331 CORE-ROUTER: Apply base config, establish WAN connectivity, OSPF adjacency to core/distribution.
2. Deploy Catalyst 9300 CORE-SW: Configure VLANs, trunks, SVIs, OSPF, edge port templates (dot1x), ACLs, QoS.
3. Deploy ASA 5516-X: Connect ASA between core and WAN, implement initial segmentation/firewall ACLs, apply IPS/IDS and logging.
4. Configure Cisco 5520 WLC: Define WLANs, VLAN associations, enable AAA radius, security controls (WPA3/802.1x), syslog/SNMP.
5. Integrate with SIEM/NMS for compliance monitoring/logging.
6. Validate P2P/L3 links, management reachability, VLAN/IP/subnet mapping.

Verification Procedures:
- OSPF adjacency: show ip ospf neighbor (ISR/C9300), show ospf on ASA
- VLAN trunking: show interfaces trunk, show vlan brief (C9300)
- AAA authentication: test aaa group radius, show radius statistics
- 802.1X: show authentication sessions, test device port logins
- QoS: show policy-map interface, verify voice prioritization
- Firewall: show access-list, verify PCI VLAN isolation/blocking
- IPS: view alerts/logs (FirePOWER/ASA), simulated attack detection
- Wireless: verify SSID broadcast, test 802.1X login, check WPA3
- Logging: verify syslog/SNMP reach SIEM, event timestamp inspection
- Audit: show running-configuration, verify periodic snapshots/events

=== DEPLOYMENT SUCCESS CRITERIA ===

✓ CONNECTIVITY: Full IP/VLAN reachability (except prohibited by policy), backup WAN failover validated
✓ ROUTING: OSPF convergence (<2s), correct route distribution, no blackholes
✓ SECURITY: PCI-DSS segregation active, all ACLs enforce zone isolation, 802.1X mandatory on all user ports, AES-256 in place, IPS generates logs/alerts
✓ MANAGEMENT: SSH/RADIUS/SNMP/Syslog/SIEM integration successful, compliance snapshot scheduled/output present, central NMS/AAA shows all devices
✓ REDUNDANCY: WAN backup tested, OSPF L3 rerouting, no single point of failure on pay/vault/critical zones